%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Preamble
\documentclass{article}
\usepackage{amsmath,amssymb,amsthm,fullpage}
\usepackage{listings}
\usepackage{graphicx}
\usepackage{fancyhdr}
\usepackage{verbatim}
\usepackage{ dsfont }
\graphicspath{{images/}}
\usepackage[a4paper,bindingoffset=0in,left=.5in,right=1in,top=1in,
bottom=1in,footskip=0in]{geometry}
\newtheorem*{prop}{Proposition}
%\newcounter{Examplecount}
%\setcounter{Examplecount}{0}
\newenvironment{discussion}{\noindent Discussion.}{}
\setlength{\headheight}{12pt}
\setlength{\headsep}{10pt}
\usepackage{fancyhdr}

\newcommand*{\wvec}{\ensuremath{\mathbf{w}}}
\newcommand*{\wb}{\ensuremath{\mathbf{w}}}
\newcommand*{\yb}{\ensuremath{\mathbf{y}}}
\newcommand*{\Xb}{\ensuremath{\mathbf{X}}}
\newcommand*{\Ib}{\ensuremath{\mathbf{I}}}

\pagestyle{fancy}
\fancyhf{}
\lhead{CS155 MiniProject 2}
\rhead{Kshitij Grover, Matt Lim, Siddharth Murching}
\begin{document}

\section*{Stochastic Gradient Descent, De-Mystified}

Since we are implementing stochastic gradient descent, we want to
compute the gradient of the following expression w.r.t $u_{n}, v_{m} \forall n \in U, m \in V$ for
a given $y_{ij}$.

$$ l =  \min_{U, V, a, b} \frac{\lambda}{2N} (||U||^{2}_{Fro} + ||V||^{2}_{Fro}
+ ||a||^{2}_{Fro} + ||b||^{2}_{Fro}) + \frac{1}{2} (y_{ij} - \mu - (u_{i}^{\intercal}v_{j} + a_{i} + b_{j}))^{2} $$

We have the following process for stochastic gradient descent:

\begin{enumerate}
    \item Randomly pick a $y_{ij}$
    \item Compute the gradient of the error function $l(i,j)$ with respect to every column
        in $U$ and every column in $V$, and every entry in $a$ and $b$.
    \item Subtract $\eta \nabla$ from $U$ $V$, $a$, and $b$
    \item Repeat steps 1-3 until $\eta \nabla < \epsilon$.
\end{enumerate}

We can compute the following partial derivatives:

$$ \frac{\partial l}{\partial_{a_{k}}} = \frac{\lambda}{N} a_{k} - \mathds{1}^{i = k}((y_{ij} - \mu) -
(u_{i}^{\intercal}v_{j} + a_{i} + b_{j})) $$

$$ \frac{\partial l}{\partial_{b_{j}}} = \frac{\lambda}{N} b_{j} - \mathds{1}^{j=k}((y_{ij} - \mu) -
(u_{i}^{\intercal}v_{j} + a_{i} + b_{j})) $$


$$ \frac{\partial l}{\partial_{u_{k}}} = \frac{\lambda}{n} u_{k} - \mathds{1}^{k = i} v_{j}((y_{ij} - \mu) -
(u_{i}^{\intercal}v_{j} + a_{i} + b_{j}))  $$

$$ \frac{\partial l}{\partial_{v_{k}}} = \frac{\lambda}{n} v_{k} + \mathds{1}^{k = j} u_{i}((y_{ij} - \mu) -
(u_{i}^{\intercal}v_{j} + a_{i} + b_{j})) $$

\section*{Choice of Parameters}
As per the set, we want to over-specify the rank of $U$ and $V$, so we will pick $k = 20$
given the concrete suggestion in the problem. We will run the risk of iterating too
many times $\eta = 0.001$.



\end{document}
